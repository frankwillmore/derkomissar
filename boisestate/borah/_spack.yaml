# System compatibility layer for borah
spack:
  view: false
  concretization: together
  config:
    concretizer: clingo
    install_tree:
      root: /cm/shared/software/derkommissar/opt
      padded_length: false
    build_stage:
#    - $tempdir/$user/spack-stage
    - /bsuhome/$user/scratch/spack-stage
  definitions:
  - use_compiler:
    - '%gcc@9.2.0'
#  - enumerated_in_e4s:
#    - autoconf@2.70
#    - automake@1.16.2
#    - berkeley-db@18.1.40
#    - binutils@2.33.1+gold+headers+libiberty~nls
#    - boost@1.74.0 cxxstd=17
#    - bzip2@1.0.8
#    - cmake@3.18.4
#    - diffutils@3.7
#    - numactl@2.0.14
#    - elfutils@0.182
#    - expat@2.2.10
#    - gdbm@1.18.1
#    - gettext@0.21
#    - help2man@1.47.11
#    - libbsd@0.10.0
#    - libiconv@1.16
#    - libsigsegv@2.12
#    - libtool@2.4.6
#    - libunwind@1.4.0
#    - libxml2@2.9.10
#    - m4@1.4.18
#    - ncurses@6.2
#    - openblas@0.3.10
#    - perl@5.32.0
#    - pkgconf@1.7.3
#    - python@3.8.6
#    - readline@8.0
#    - sqlite@3.33.0
#    - tar@1.32
#    - texinfo@6.5
#    - xz@5.2.5
#    - zlib@1.2.11
#  - not_in_e4s:
#    - hwloc@1.11.13
#    - util-linux-uuid
#    - libffi
#    - json-c

  specs:
  
#  - matrix:
#    - [$enumerated_in_e4s]
#    - [$use_compiler]
#  - openssl@1.1.1k~docs+systemcerts %gcc@9.2.0
  - openssl@1.1.1m
  - libtool@2.4.6
  - autoconf
  - automake
  - mpich@3.4.2+cuda
  - zlib@1.2.11
  - ruby@3.1.0

# - binutils@2.36.1
# - bison@3.8.2 

  packages:
    all:
      providers:
        blas: [openblas]
        mpi:
        - mpich
      permissions:
        read: world
        write: user
      target: [x86_64]
    openssl:
      externals:
      - spec: openssl@1.1.1m
        prefix: /usr
      buildable: false
  #  mpich:
  #    version:
  #    - 3.4.2
  compilers:
  
  # A new-ish gcc version, built for x86_64 so it will run on any architecture. 
  # Target is set to x86_64 so it will build other compilers (e.g. oneapi)
  # to run on any architecture.
  - compiler:
      spec: gcc@9.2.0
      paths:
        cc: /cm/local/apps/gcc/9.2.0/bin/gcc
        cxx: /cm/local/apps/gcc/9.2.0/bin/gcc
        f77: /cm/local/apps/gcc/9.2.0/bin/gfortran
        fc: /cm/local/apps/gcc/9.2.0/bin/gfortran
      flags: {}
      operating_system: centos7
      target: x86_64
      modules: []
      environment: {}
      extra_rpaths: []
  mirrors:
    spack-mirror: file:///cm/shared/software/mirror
